---
title: "Bacterial richness in public tap water and sinks of San Francisco's public Pit Stop bathrooms"
author: "Andrae Ladores"
date: "April 4, 2022"
bibliography: references.bib
csl: ecology.csl
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages}
# If you add any additional packages here, make sure they are
# also listed in the DESCRIPTION file
library("dplyr")
library("tidyr")
library("ggplot2")
library("readr")
library("ggmap")
library("tidycensus")
library("tidyverse")
census_api_key("90f27dca0437203c57cb264c2b8efccbf7056737")
```

# Introduction
Throughout the world and including the United States, there are numerous individuals that are deprived of safe and reliable tap water. Cities like Newark, New Jersey and Flint, Michigan are only some examples of the water crisis in the United States [@doi:10.2105/AJPH.2021.306561]. In California, there is a small percentage of public tap water systems that have been found to be in violation at least one point in their time since 2012 [@reese2018does]. Further studies have revealed that water system violations in California transpire in low-income communities, where there are limited resources which makes it difficult to meet the standards, driving the inequitable access to safe tap water [@balazs2012environmental; @doi:10.2105/AJPH.2013.301664]. 
Besides access to safe public water, public restrooms are a necessity as well. They provide service to a mobile population and assists the individuals with greater needs (children, elderly, the homeless, etc.) [@STANWELLSMITH2010613]. In addition, public restrooms in high-income locations are known to display cleaner facilities and conditions compared to the restrooms in low and medium-income areas [@suen2019public].

In this study, I focused on the bacterial richness in public tap water of San Francisco's public restrooms (Pit Stop bathrooms) and how they vary regarding population density and the average neighborhood income. Additionally, I tested the pH levels between Outer Richmond's Lake Stow and Lakeshore's Lake Merced to investigate the pH levels between the lakes with differing green space. The study revolves around the use of field collected data across several districts of San Francisco and the use of pre-existing datasets relating to the study of different urban systems. The field collected data consisted of tap water samples of Pit Stop bathrooms along with swab samples of several locations on the sink in the same bathrooms. The publicly-available datasets consisted of information pertaining to San Francisco's average income values along with San Francisco's census data.  

# Materials and Methods

## Location and Pit Stop Restrooms
As a class group, we decided which districts of San Francisco we wanted to study based on an official San Francisco district map. We concluded to observing Haight (HA), Marina (MA), Outer Richmond (OR), Civic Center (CC), Mission (MI), Bayview (BA), and Lakeshore (LA). We used Professor Zimmerman's R code that randomly plotted points within a neighborhood to determine the exact position we should stop at via bus services.

Pit Stop bathrooms were the main public bathrooms studied and sampled. In neighborhoods where there were two Pit Stop bathrooms in close proximity to the predetermined bus stop, I sampled both bathrooms (B1 & B2), otherwise, I only sampled a single bathroom. San Francisco Public Work's Pit Stop program supplies the public with safe and sanitized restrooms. Outside or near each unit contains used-needle disposals, animal waste stations, and a regular trash disposal. Inside each restroom contains a hands-free sink, soap, paper towels, toilet, and toilet paper. In addition, each unit gets automatically cleaned after each use and will get manually cleaned by a staff member periodically. Currently, there are 33 Pit Stop locations across 13 neighborhoods. The program utilizes street-cleaning data which determines the placement of each Pit Stops, placing the public restrooms where they are essential [@PitStop]. There were some neighborhoods that did not contain a Pit Stop bathroom, in which case, I just found the nearest public restroom, which was often near or in public parks. It's also important to note that these non Pit Stop restrooms contained bathroom facilities with both Men and Women options. In those cases, I sampled the Men's side (B2) and I would have my female-identifying peer to assist in collecting my samples for the Women's side (B1).

## TSA plates
The TSA plates used were prepared using 40g/L of tryptic soy agar and placed into an autoclavable glassware. Then, the addition of distilled and deionized water was added until the desired volume was reached. Once reached, the glasswared was autoclaved at 121°C for 30 minutes on liquid cycle. When it was ready, the product was poured into 100mm petri dishes to cool and stored in a closed bag at 4°C until eventually used. 

## Tubes and Swabbing
For the data collection, I used 15mL falcon or centrifuge tubes containing 0.75mL phosphate buffered saline (PBS) 1x pH 7.4 which was autoclaved for 30 minutes at 121°C liquid cycle. Inside a Pit Stop bathroom, I used sterile cotton swabs which I would first dip into the PBS filled centrifuge tubes prior to swabbing three locations on the sink: the area around the spout (s1), the drain (s2), and the handle/arm rest area (s3). I would swab for 3-4 seconds and I would immediately place the swab back into its respective tube. For the negative control (c/control), I simply mimicked the same actions when swabbing the sink, but I simply swabbed the air with the same amount of time. For the water (w), I took an empty centrifuge tube without PBS and took a water sample from the automatic sink. For each Pit Stop unit, I had a total of 5 centrifuge tubes: the 3 sink samples, 1 control sample, and 1 water sample. 

## Plating and Counting
Once I returned from the sample sites with my centrifuge tubes, I vortexed each centrifuge tube for 30-40 seconds. After vortexing, each tube sample (except the water sample) is aliquoted onto its respective TSA plate with a value of 0.075mL. The water sample is aliquoted with the same value of 0.075mL onto a TSA plate, but with 3 technical replicates. Per restroom, there are 7 total plates: 3 plates for the sink samples, 3 plates for the water sample, and 1 plate for the control. Once the samples are plated, approximately 7-12 sterilized glass beads are poured into the plates and each plate is shaken for 15-20 seconds or until the sample on the plate has adequately spread across the area. Once each plate has been thoroughly shaken and spread, the plates are incubated at around 37°C for 5 days.

After the incubation period, the plates are taken out for observation. Each plate is carefully observed and recorded for bacterial richness. I documented the morphology type of each bacteria, the count of each morphology type on the plate, and the overall total bacterial count present on each plate. After each plate is carefully studied and documented, the plate is properly discarded. 

## Statistical Analysis
To analyze the data accumulated throughout the field work, I used boxplots, barplots, map figures, and scatterplots to illustrate my findings. For the boxplot figures created, I ran an ANOVA for the figures that contained three or more categorical variables to test for significance. For the boxplots that contained just two categorical variables, I used an independent t-test to test for significance. For the barplot figure, I subsetted the morphotype description names and their count, then I took the top ten morphotype count and plotted the results into a barplot to visualize the most abundant morphotypes. In terms of the scatterplots and regression lines, I used a paired t-test to determine significance. For all the statistical analysis to determine significance, I used a level of significance of 0.05.

## Field Sampling Design

Add text here.

## Data Analysis

```{r read-in-bathroom-count-and-bathroom-sample-datasets}
# read in entire bathroom count data
bathroom_count <- read_csv(
  "data/raw_data/2022-05-04_2022_spring_urban_ecology_data_Bathroom_count.csv")

# read in entire bathroom sample data
bathroom_sample <- read_csv(
  "data/raw_data/2022-05-03_2022_spring_urban_ecology_data_Bathroom_sample.csv")
```

```{r boxplot-total-colony-count-and-neighborhood}
# create boxplot with total colony count vs. neighborhood district
ggplot(data = bathroom_count,
       aes(x = neighborhood,
           y = colony_count_per_plate,
           color = neighborhood)) +
  geom_boxplot() +
  scale_y_log10() +
  labs(x = "Neighborhood",
       y = "Total Colony Count",
       title = "Count of Total Bacterial Colonies On Different Neighborhoods",
       scale_fill_manual = "Neighborhoods")
```
**Figure 1**: The total bacterial colony count was significantly different throughout the various San Francisco neighborhoods (ANOVA p < 0.05). 

```{r run-anova-on-colony-count-and-neighborhood}
# statistical test to see if above results are significant.
summary(lm(data = bathroom_count, colony_count_per_plate ~ neighborhood))
```
```{r boxplot-total-colony-count-only-civic-center-and-outer-richmond}
# create boxplot for the total colony count for only Civic Center and
# Outer Richmond neighborhoods.
bathroom_count %>%
  filter(neighborhood %in% c("OR", "CC")) %>%
  ggplot(aes(x = neighborhood,
             y = colony_count_per_plate,
             color = neighborhood)) +
  geom_boxplot() +
  scale_y_log10() +
  labs(x = "Neighborhood",
       y = "Total Colony Count",
       title = "Count of Bacterial Colonies In Outer Richmond and Civic Center")
```
**Figure 2**: The total bacterial colony count was significantly different between Civic Center and Outer Richmond neighborhoods (t-test p < 0.05). 
```{r run-t-test-on-colony-count-and-neighborhood}
# statistical test to see if above results are significant.
bathroom_count %>%
  filter(neighborhood %in% c("OR", "CC")) %>%
  lm(data = ., colony_count_per_plate ~ neighborhood) %>%
  summary()
```

```{r boxplot-total-colony-count-and-sink-location}
# create boxplot with total plate count and the different sink locations.
bathroom_count %>%
  filter(sample %in% c("s1", "s2", "s3")) %>%
  ggplot(aes(x = sample, y = colony_count_per_plate, color = sample)) +
  geom_boxplot() +
  labs(x = "Sink Location",
       y = "Total Colony Count",
       title =
         "Count of Total Bacterial Colonies On Different Locations On The Sink")

```
**Figure 3**: The total bacterial colony count was not significantly different between various sink locations (ANOVA p < 0.05). 
```{r run-anova-on-colony-count-and-sink-locations}
# statistical test to see if above results are significant.
bathroom_count %>%
  filter(sample %in% c("s1", "s2", "s3")) %>%
  lm(data = ., colony_count_per_plate ~ sample) %>%
  summary()
```

```{r table-morphology-type-and-morphology-count}
# subset bathroom count data to only contain morphotype ID and morphotype count.
# Then only have the top 10 morphotype counts.
bathroom_count_table <- bathroom_count %>%
  select(morphotype_id, morphotype_count) %>%
  arrange(desc(morphotype_count)) %>%
  head(10)
```

```{r create-barplot-for-morphotype-id-and-counts}
# create barplot that showcases the top morphotype IDs and their counts.
bathroom_count_barplot <- ggplot(data = bathroom_count_table,
                                   aes(x = morphotype_id,
                                       y = morphotype_count,
                                       fill = morphotype_id)) +
  geom_bar(stat = "identity") +
    scale_fill_manual(values = c("#CDCDC1",
                               "#CDB38B",
                               "#9FB6CD",
                               "#CDCD00")) +
    labs(title = "Bacterial Morphotype Description and The Specific Counts",
         x = "Morphotype Description",
         y = "Morphotype Count")
bathroom_count_barplot
```
**Figure 4**: Barplot of the top ten morphotype descriptions. 
```{r sf-base-map}
# load in base sf map
sf_basemap <- ggmap::get_stamenmap(bbox = c(-122.533264,
                                            37.700984,
                                            -122.355307,
                                            37.817383),
                                   zoom = 13,
                                   maptype = "terrain")

```

```{r sf-map-of-sampled-bathroom-locations}
# plot basemap with each bathroom sample location for each neighborhood
ggmap(sf_basemap) +
  geom_point(data = bathroom_sample,
             aes(x = long_dec_degrees,
                 y = lat_dec_degrees,
                 color = neighborhood,
                 shape = bathroom_type),
             size = 3) +
  labs(title = "Bathroom Site Sampling Locations In San Francisco",
       x = "Longitude",
       y = "Latitude")
```
**Figure 5**: Sampled Bathroom Sites throughout San Francisco's neighborhoods.

```{r scatter-plot-and-regression-line-mean-median-income-and-total-colony}
 bathroom_count %>%
    ggplot(aes(y = colony_count_per_plate, # plot sample type data
               x = mean_median_income)) + # plot colony count data
    geom_point(color = "black") +
    geom_smooth(method = "lm", se = FALSE, color = "purple") +
    labs(title = "Total Colony Count On Bathroom Based On
      The Mean Median Income of San Francisco Neighborhoods",
       x = "Mean Median Income",
       y = "Total Colony Count")
```
**Figure 6**: The total bacterial colony count was significantly different throughout the varied average income (p < 0.05). 
```{r run-statistical-test-for-total-colony-count-and-average-income}
# statistical test to see if above results are significant.
summary(lm(data = bathroom_count, colony_count_per_plate ~ mean_median_income))
```

```{r scatter-plot-and-regression-line-mean-median-population-and-total-colony}
bathroom_count %>%
  ggplot(aes(y = mean_median_population, # plot population
             x = colony_count_per_plate,
             color = bathroom_type)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "#B03060") +
  labs(title = "Total Colony Count On Bathroom Based On
      The Average Population of San Francisco Neighborhoods",
      x = "Average Population",
      y = "Total Colony Count")

```
**Figure 7**: The total bacterial colony count was significantly different throughout the average population (p < 0.05). 
```{r run-statistical-test-for-total-colony-count-and-average-population}
# statistical test to see if above results are significant.
bathroom_count %>%
  lm(data = ., colony_count_per_plate ~ mean_median_population) %>%
  summary()
```

# Results

## Microbial Richness
I observed that the overall bacterial richness throughout the sampled bathroom and their neighborhoods (Figure 5) was significantly different with an ANOVA p-value of 2.17E-6; p < 0.05 (Figure 1). Comparing two specific neighborhood’s bacterial richness, Outer Richmond and Civic Center/Tenderloin, with differing average income, I found that the bacterial richness was significantly different between Civic Center/Tenderloin and Outer Richmond area with a t-test p-value of 0.02708; p < 0.05 (Figure 2). Furthermore, I observed the relationship between the bacterial richness and the varying sink locations and found that the bacterial richness was not significantly different between the various sink locations (Figure 3; p-value = 0.6912; p < 0.05). 

## Morphotypes
My barplot (Figure 4) to analyze the top morphotype count of the various morphotype identification descriptions and their respective bacterial abundance, found that the morphotype identification, tiny, taupe, had the most frequent and abundant morphotype count of 14,032. The second most abundant morphotype, tiny, yellow, amounted to a morphotype count of 3,116. That is a 10,916 difference between the most abundant morphotype, tiny, taupe, and the second most abundant morphotype, tiny, yellow. Furthermore, the morphotypes, tiny, transparent, totaled to the value of 2,288 and small, opaque, measured to a total of 1728.

## Average Income & Population
The scatterplot to measure the microbial richness along with the average income in San Francisco’s neighborhoods was significantly different with a p-value of 0.006631; p < 0.05 (Figure 6). Similarly, the relationship between the microbial richness and the average population throughout San Francisco was significant, it had a t-test value of p-value of 3.024E-6, p < 0.05 (Figure 7).

# Discussion

# Sources Cited

